#!/usr/bin/env bash

### IMPORTANT!!!
### Keep this file in sync with action.yml

echo ""
echo "CREATING PDFs..."
echo ""
grep -l "window\.PrimerSpecConfig" _site/**/*.html _site/*.html | while read -r file
do
  relativePath=${file#_site/}
  pdfFile="_site/assets/primer-spec-pdf/${relativePath%.html}.pdf"
  pdfFileDir=${pdfFile%/*}
  echo "Source: $file"
  echo "Dest: $pdfFile"
  echo "In directory: $pdfFileDir"
  echo ""
  mkdir -p $pdfFileDir
  # chrome --headless --disable-gpu --run-all-compositor-stages-before-draw --print-to-pdf-no-header --print-to-pdf=="$pdfFile" $file
  chrome --headless --print-to-pdf=="$pdfFile" $file
done
